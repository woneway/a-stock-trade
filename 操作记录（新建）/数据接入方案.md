# 数据接入方案文档

> 更新时间: 2026-02-26

## 一、复盘和计划所需数据

### 1.1 每日复盘数据

| 数据项 | 说明 | 来源 | 优先级 |
|--------|------|------|--------|
| 大盘指数 | 上证、深证、创业板指 | 开盘啦/第三方API | ⭐⭐⭐⭐⭐ |
| 涨跌家数 | 上涨/下跌/平盘 | 开盘啦/第三方API | ⭐⭐⭐⭐⭐ |
| 涨停数量 | 今日涨停板数量 | 开盘啦 | ⭐⭐⭐⭐⭐ |
| 跌停数量 | 今日跌停板数量 | 开盘啦 | ⭐⭐⭐⭐⭐ |
| 炸板数量 | 今日炸板数量 | 开盘啦 | ⭐⭐⭐⭐ |
| 炸板亏损 | 最大炸板亏损幅度 | 开盘啦 | ⭐⭐⭐⭐ |
| 涨停列表 | 所有涨停股详情 | 开盘啦 | ⭐⭐⭐⭐⭐ |
| 首板列表 | 首板涨停股详情 | 开盘啦 | ⭐⭐⭐⭐ |
| 热门板块 | 涨停最多的板块 | 开盘啦 | ⭐⭐⭐⭐⭐ |
| 资金流向 | 主力资金流入流出 | 开盘啦/第三方API | ⭐⭐⭐⭐ |
| 短线精灵 | 异动信号列表 | 开盘啦 | ⭐⭐⭐ |

### 1.2 明日计划数据

| 数据项 | 说明 | 来源 | 优先级 |
|--------|------|------|--------|
| 推荐板块 | 明日关注板块 | AI分析 | ⭐⭐⭐⭐⭐ |
| 推荐个股 | 明日关注个股 | AI分析 | ⭐⭐⭐⭐⭐ |
| 买入条件 | 具体买入条件 | 手动填写 | ⭐⭐⭐⭐⭐ |
| 仓位建议 | 建议持仓比例 | AI分析 | ⭐⭐⭐⭐ |
| 止损位置 | 止损价位 | 手动填写 | ⭐⭐⭐⭐⭐ |
| 风险提示 | 风险提示信息 | AI分析 | ⭐⭐⭐ |

---

## 二、数据来源分析

### 2.1 开盘啦 (当前使用)

**优点**:
- 界面直观，数据丰富
- 包含独特数据：炸板亏钱效应、短线精灵等

**缺点**:
- 无公开API
- 需要自动化截图+OCR识别

### 2.2 Tushare (推荐)

**官网**: https://tushare.pro/

**优点**:
- 数据全面，接口稳定
- 支持历史数据查询
- 有Python SDK

**缺点**:
- 需要注册获取token
- 部分数据需要付费

**可获取数据**:
- [ ] 每日涨跌停数据
- [ ] 板块涨跌数据
- [ ] 资金流向数据
- [ ] 大盘指数数据

### 2.3 AkShare (推荐)

**官网**: https://akshare.akfamily.xyz/

**优点**:
- 完全免费
- 无需注册
- Python库直接使用

**缺点**:
- 数据可能有延迟
- 无历史数据

**可获取数据**:
- [ ] 实时行情
- [ ] 涨停板数据
- [ ] 板块排行
- [ ] 资金流向

### 2.4 东方财富/同花顺

**优点**:
- 数据权威
- 实时性好

**缺点**:
- API不对个人开放
- 需要破解或第三方接入

---

## 三、开盘啦数据采集方案

### 3.1 方案A: OCR识别 (当前方案)

**流程**:
```
开盘啦APP → 截图 → OCR识别 → 结构化数据 → 存储
```

**工具**:
- 截图: screencapture (macOS)
- OCR: Tesseract / 云OCR (阿里云、腾讯云)

**优点**:
- 无需APP配合
- 可获取全部界面数据

**缺点**:
- OCR识别可能有误差
- 需要处理图片格式
- 速度较慢

### 3.2 方案B: 应用数据分析

**流程**:
```
开盘啦APP → 分析应用数据 → 提取数据 → 存储
```

**方法**:
- 使用LLDB分析应用内存
- 抓取应用网络请求
- 分析本地数据库

**优点**:
- 数据准确
- 实时性好

**缺点**:
- 技术难度高
- 可能违反APP使用条款
- 数据结构可能变化

### 3.3 方案C: 第三方API补充

**流程**:
```
开盘啦(特色数据) + Tushare/AkShare(基础数据) → 融合 → 存储
```

**推荐组合**:
| 数据类型 | 来源 |
|----------|------|
| 炸板数据 | 开盘啦 (OCR) |
| 短线精灵 | 开盘啦 (OCR) |
| 涨停板 | Tushare/AkShare |
| 板块数据 | Tushare/AkShare |
| 大盘指数 | Tushare/AkShare |
| 资金流向 | Tushare/AkShare |

---

## 四、推荐实施方案

### 4.1 短期方案 (快速见效)

1. **保持开盘啦手动采集**
   - 继续使用当前方式收集数据
   - 改进前端表单，手动录入

2. **补充基础数据**
   - 接入AkShare获取基础行情数据
   - 补充大盘指数、资金流向

### 4.2 中期方案 (效率提升)

1. **OCR自动化**
   - 实现截图自动识别
   - 自动填充表单

2. **数据存储结构化**
   - 创建复盘数据表
   - 支持历史查询

### 4.3 长期方案 (完全自动化)

1. **数据源整合**
   - 开盘啦(特色数据) + 第三方(基础数据)
   - AI自动分析生成复盘

2. **智能推荐**
   - 基于历史数据学习
   - 自动生成操作建议

---

## 五、下一步行动

- [ ] 评估AkShare接入可行性
- [ ] 设计复盘数据结构
- [ ] 改进前端复盘表单
- [ ] 实现OCR自动识别 (可选)

---

## 六、开盘啦数据采集技术实现

### 6.1 当前实现方式

**使用工具**: pyobjc + Quartz 框架 (macOS)

### 6.2 菜单坐标参考

| 菜单项 | 坐标(窗口相对) |
|--------|----------------|
| 开盘啦数据 | x+50, y+50 |
| 实时公告 | x+50, y+90 |
| 涨停分析 | x+50, y+115 |
| 首板分析 | x+50, y+150 |
| 板块监测 | x+50, y+200 |
| 短线精灵 | x+50, y+260 |
| 炸板亏钱效应 | x+50, y+300 |

### 6.3 推荐的数据存储结构

```python
class DailyReview:
    trade_date: date
    market_sentiment: int
    up_count: int
    limit_up_count: int
    break_up_count: int
    hot_sectors: JSON
    limit_up_stocks: JSON
```

---

*文档创建时间: 2026-02-26*
