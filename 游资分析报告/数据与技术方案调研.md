# 数据与技术方案调研报告

> 深度调研游资系统所需数据的API、APP及实现方案

---

## 一、数据源调研总结

### 1.1 可用数据API汇总

| 数据类型 | 数据源 | 可用性 | 费用 | 说明 |
|----------|--------|--------|------|------|
| **实时行情** | Tushare Pro | ✅ 可用 | 免费/付费 | 需要注册获取token |
| **历史行情** | Tushare Pro | ✅ 可用 | 免费/付费 | 积分制，基础数据免费 |
| **龙虎榜** | Tushare Pro | ✅ 可用 | 需积分 | `daily`接口 |
| **涨跌停** | Tushare Pro | ✅ 可用 | 需积分 | `stk_limit`接口 |
| **实时涨跌家数** | 咕咕数据 | ✅ 可用 | 付费 | 999元/年 |
| **涨停板实时** | 咕咕数据 | ✅ 可用 | 付费 | 999元/年 |
| **板块数据** | Tushare Pro | ✅ 可用 | 需积分 | 概念板块分类 |
| **资金流向** | Tushare Pro | ✅ 可用 | 需积分 | `moneyflow`接口 |

### 1.2 各类数据实现方案

#### A. 情绪周期数据

**方案一：Tushare + 自建计算**

```
数据来源：Tushare Pro
├── pro.daily() - 获取每日涨跌停数据
├── pro.stk_limit() - 获取涨跌停价格
└── 自建计算模块 - 计算涨跌家数比、炸板率等
```

**方案二：东方财富网页爬取（不推荐）**

- 优点：免费
- 缺点：不稳定、可能被封、违反服务条款

**推荐方案**：使用Tushare基础接口 + 自建情绪计算模块

#### B. 龙虎榜数据

**Tushare龙虎榜接口**：

```python
# 每日龙虎榜数据
pro.daily(trade_date='20240224')

# 个股龙虎榜
pro.top_inst(trade_date='20240224', ts_code='000001.SZ')

# 营业部数据
pro.top_list(trade_date='20240224')
```

**数据字段**：
- 买入/卖出营业部
- 买入/卖出金额
- 净买入金额
- 上榜原因

#### C. 板块效应数据

**Tushare概念板块**：

```python
# 概念板块列表
pro.concept()

# 概念板块成分股
pro.concept_detail(ts_code='TS0001')
```

**自建板块涨停统计**：
1. 获取当日涨停股票列表
2. 获取每只股票所属板块
3. 统计各板块涨停数量
4. 排序输出热点板块

---

## 二、现有APP分析

### 2.1 主流股票APP功能对比

| APP | 情绪周期 | 龙虎榜 | 板块效应 | 龙头股 | 回测 | 适合人群 |
|-----|----------|--------|----------|--------|------|----------|
| **同花顺** | ⚠️ 基础 | ✅ 完整 | ✅ 完整 | ✅ 有 | ❌ 无 | 散户/新手 |
| **东方财富** | ⚠️ 基础 | ✅ 完整 | ✅ 完整 | ✅ 有 | ❌ 无 | 散户/新手 |
| **通达信** | ⚠️ 基础 | ✅ 完整 | ✅ 完整 | ✅ 有 | ❌ 无 | 职业选手 |
| **雪球** | ✅ 社区 | ⚠️ 第三方 | ⚠️ 第三方 | ⚠️ 第三方 | ❌ 无 | 社交投资 |
| **聚宽** | ❌ 无 | ✅ 数据 | ✅ 数据 | ❌ 无 | ✅ 完整 | 量化玩家 |
| **BigQuant** | ❌ 无 | ✅ 数据 | ✅ 数据 | ❌ 无 | ✅ 完整 | 量化玩家 |

### 2.2 各APP详细说明

#### 同花顺
- **优点**：界面友好、数据全、问财智能选股
- **缺点**：无情绪周期量化、无回测
- **龙虎榜**：完整，每日更新
- **适合**：日常看盘

#### 东方财富
- **优点**：股吧社区活跃、研报质量高
- **缺点**：社区信息嘈杂
- **龙虎榜**：完整
- **适合**：跟踪市场情绪

#### 通达信（职业版）
- **优点**：游资常用、可定制指标
- **缺点**：界面复杂
- **龙虎榜**：完整
- **适合**：职业交易者

#### 聚宽/BigQuant
- **优点**：完整回测、数据API
- **缺点**：无情绪周期、无龙虎榜实时
- **适合**：量化研究

### 2.3 结论

**现有APP的局限性**：
1. 无完整的情绪周期量化系统
2. 无游资席位历史追踪
3. 无龙头股自动识别
4. 无完整回测（聚宽有但不完善）

**这正是我们系统的机会**！

---

## 三、技术实现方案

### 3.1 数据层架构

```
┌─────────────────────────────────────────────────────┐
│                    数据源层                          │
├─────────────────────────────────────────────────────┤
│  Tushare Pro    │  东方财富网页  │  自建数据       │
│  (主要数据)      │  (备份/实时)    │  (情绪计算)     │
└─────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│                    数据处理层                        │
├─────────────────────────────────────────────────────┤
│  数据清洗  │  情绪计算  │  板块分析  │  龙头识别   │
└─────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│                    数据存储层                        │
├─────────────────────────────────────────────────────┤
│  SQLite (本地)   │   PostgreSQL (生产)              │
└─────────────────────────────────────────────────────┘
```

### 3.2 情绪周期计算实现

```python
# 情绪周期计算服务
class EmotionCycle:
    def __init__(self, tushare_token):
        self.pro = ts.pro_api(tushare_token)

    def calculate_cycle(self, trade_date):
        # 1. 获取涨跌停数据
        limit_df = self.pro.daily(trade_date=trade_date)

        # 2. 计算涨跌家数
        up_count = len(limit_df[limit_df['pct_chg'] > 0])
        down_count = len(limit_df[limit_df['pct_chg'] < 0])
        total = up_count + down_count
        up_ratio = up_count / total if total > 0 else 0

        # 3. 获取涨停数量
        limit_up = self.pro.stk_limit(trade_date=trade_date)
        limit_count = len(limit_up)

        # 4. 获取连板高度
        height_limit = self.get_height_limit(trade_date)

        # 5. 判断情绪阶段
        return self.judge_cycle(up_ratio, limit_count, height_limit)

    def judge_cycle(self, up_ratio, limit_count, height_limit):
        """判断情绪周期阶段"""
        # 冰点期
        if up_ratio < 0.2 or limit_count < 30:
            return 'ice_point', 0.1

        # 回暖期
        elif up_ratio < 0.4:
            return 'recovery', 0.3

        # 发酵期
        elif up_ratio < 0.6:
            return 'fermentation', 0.5

        # 高潮期
        elif up_ratio > 0.8 or limit_count > 60:
            return 'peak', 0.3

        # 退潮期
        else:
            return 'retreat', 0.0
```

### 3.3 龙虎榜数据接入

```python
# 龙虎榜数据服务
class DragonTigerList:
    def __init__(self, tushare_token):
        self.pro = ts.pro_api(tushare_token)

    def get_daily_lhb(self, trade_date):
        """获取每日龙虎榜数据"""
        df = self.pro.daily(trade_date=trade_date)
        return df

    def get_top_inst(self, trade_date, ts_code=None):
        """获取机构买卖"""
        if ts_code:
            df = self.pro.top_inst(trade_date=trade_date, ts_code=ts_code)
        else:
            df = self.pro.top_inst(trade_date=trade_date)
        return df

    def track_seat(self, seat_name, days=30):
        """追踪特定席位历史操作"""
        # 查询该席位在特定日期的买入/卖出
        # 返回：该席位近期操作的股票列表、胜率等
        pass
```

### 3.4 龙头股识别实现

```python
# 龙头股识别
class LeaderStock:
    def identify_leader(self, sector, trade_date):
        # 1. 获取该板块所有涨停股
        limit_stocks = self.get_limit_stocks_by_sector(sector, trade_date)

        # 2. 获取成交额排序
        sorted_stocks = sorted(limit_stocks, key=lambda x: x.amount, reverse=True)

        # 3. 筛选龙头候选
        candidates = []
        for stock in sorted_stocks:
            if stock.turnover_rate > 10:  # 高换手
                if stock.amount > 1e8:    # 高成交
                    if stock.limit_days >= 2:  # 连板
                        candidates.append(stock)

        # 4. 返回龙头
        return candidates[:3]  # 前3名为龙头候选
```

### 3.5 回测系统实现

**推荐使用Backtrader框架**：

```python
import backtrader as bt

class MyStrategy(bt.Strategy):
    def __init__(self):
        self.sma = bt.indicators.SimpleMovingAverage(
            self.data.close, period=15)

    def next(self):
        if self.data.close[0] > self.sma[0]:
            self.buy()
        elif self.data.close[0] < self.sma[0]:
            self.sell()

# 回测
cerebro = bt.Cerebro()
cerebro.addstrategy(MyStrategy)

# 添加数据
data = bt.feeds.PandasData(dataname=df)
cerebro.adddata(data)

# 运行
cerebro.run()
cerebro.plot()
```

**更适合游资策略的回测扩展**：

```python
# 自定义回测引擎 - 支持游资特殊规则
class YiZiBacktest(bt.Backtrader):
    def __init__(self):
        super().__init__()
        self.emotion_cycle = EmotionCycle()
        self.position_manager = PositionManager()

    def next(self):
        # 获取当前情绪周期
        cycle = self.emotion_cycle.get_current_cycle()

        # 根据情绪调整仓位
        target_position = self.position_manager.get_position(cycle)

        # 执行策略
        self.execute_strategy(target_position)
```

---

## 四、成本分析

### 4.1 API费用

| 数据源 | 免费额度 | 付费价格 | 推荐度 |
|--------|----------|----------|--------|
| Tushare Pro | 基础数据 | 0-500元/月 | ⭐⭐⭐⭐⭐ |
| 咕咕数据 | 无 | 999元/年 | ⭐⭐⭐ |
| 东方财富网页 | 免费 | 0 | ⭐⭐（备用） |

### 4.2 Tushare积分说明

| 积分 | 可用接口 | 价格 |
|------|----------|------|
| 0-100 | 基础数据 | 免费 |
| 100-500 | 日线数据 | 约100元/月 |
| 500+ | 全部数据 | 约300元/月 |

### 4.3 推荐方案

**低成本方案（推荐）**：
1. Tushare Pro (100积分) - 免费基础数据
2. 自建情绪计算模块
3. 自建龙虎榜分析
4. 咕咕数据作为实时涨跌停补充（可选）

**完整方案**：
1. Tushare Pro (500积分) - 全部数据
2. 自建全模块
3. Backtrader回测

---

## 五、实施建议

### 5.1 短期（1-2周）

**目标**：实现基础数据接入和展示

| 任务 | 数据源 | 产出 |
|------|--------|------|
| Tushare接入 | Tushare | 行情数据 |
| 情绪指标计算 | 自建 | 情绪Dashboard |
| 龙虎榜展示 | Tushare | 龙虎榜列表 |

### 5.2 中期（2-4周）

**目标**：实现核心游资功能

| 任务 | 数据源 | 产出 |
|------|--------|------|
| 龙头股识别 | Tushare+自建 | 龙头推荐 |
| 板块效应分析 | Tushare | 热点板块 |
| 仓位建议 | 自建 | 仓位Dashboard |

### 5.3 长期（4-8周）

**目标**：实现高级功能

| 任务 | 数据源 | 产出 |
|------|--------|------|
| 回测系统 | Backtrader | 回测引擎 |
| 策略优化 | 自建 | 策略评分 |
| 交割单分析 | 自建 | 经验总结 |

---

## 六、总结

### 6.1 数据可用性

| 功能 | 成熟API | 实现难度 |
|------|---------|----------|
| 实时行情 | ✅ Tushare | 低 |
| 历史数据 | ✅ Tushare | 低 |
| 龙虎榜 | ✅ Tushare | 低 |
| 涨跌停统计 | ✅ Tushare | 低 |
| 板块效应 | ✅ Tushare | 中 |
| 情绪周期 | ⚠️ 需自建 | 中 |
| 龙头识别 | ⚠️ 需自建 | 中 |
| 回测系统 | ✅ Backtrader | 中 |

### 6.2 结论

1. **数据源充足**：Tushare可满足90%需求
2. **情绪周期需自建**：现有APP均无完整量化系统
3. **回测有成熟框架**：Backtrader可满足需求
4. **我们的机会**：打造游资专属的"情绪+龙头+回测"一体化系统

### 6.3 推荐技术栈

```
数据层：Tushare Pro + SQLite/PostgreSQL
计算层：Python + Pandas + NumPy
回测层：Backtrader（扩展）
前端层：React + TypeScript（现有）
```

---

*本报告基于网络调研产出，具体价格和功能以各平台官方为准。*
