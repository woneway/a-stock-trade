# 游资数据分析获取指南

本文档整理了获取游资分析所需数据的平台和API，按照数据需求分类整理。

---

## 一、数据需求清单

根据游资分析方法论，需要获取以下数据：

| 需求类型 | 具体数据项 |
|---------|-----------|
| 情绪周期 | 涨停/跌停数量、连板高度、炸板率、赚钱/亏钱效应 |
| 板块效应 | 板块涨跌停数量、资金流向、板块轮动 |
| 选股数据 | 换手率、量比、股价、振幅、均线 |
| 买卖条件 | 实时行情、资金流向、龙虎榜、技术指标 |
| 量化选股 | 历史K线、MACD、KDJ、RSI等指标 |
| 游资席位 | 龙虎榜营业部数据、游资操作历史、席位资金流向 |

---

## 二、游资策略核心指标详解与数据获取

### 1. 情绪周期指标

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 涨停数量 | 当日涨停股票总数 | AkShare: `stock_zh_a_limit_up_em()` |
| 跌停数量 | 当日跌停股票总数 | AkShare: `stock_zh_a_limit_down_em()` |
| 炸板率 | (曾涨停未封住/总涨停)×100% | 需自定义计算：获取当日触及涨停的股票，减去封住涨停的 |
| 连板高度 | 当前市场最高连板数 | AkShare: `stock_zh_a_limit_up_em()` + 筛选连板数 |
| 昨日涨停今日表现 | 昨日涨停股今日涨跌统计 | 对比`stock_zh_a_limit_up_em()`历史数据 |
| 红盘/绿盘比 | 上涨/下跌家数比例 | AkShare: `stock_zh_a_spot_em()` 统计 |
| 空间板 | 当前最高连板股 | 从涨停数据中筛选最高连板 |

### 2. 板块效应指标

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 板块涨停数 | 各板块涨停股数量 | `stock_zh_a_limit_up_em()` 按板块分组 |
| 板块资金流向 | 各板块主力资金净流入 | AkShare: `stock_sector_fund_flow_rank()` |
| 板块涨幅 | 各板块涨跌幅 | AkShare: `stock_board_industry_name_em()` |
| 板块换手率 | 板块整体换手率 | 从成分股换手率汇总计算 |
| 板块联动性 | 龙头涨停后跟风反应时间 | 需分析分时数据 |

### 3. 选股量化指标

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 换手率 | 当日成交股数/流通股本 | AkShare: `stock_zh_a_spot_em()['换手率']` |
| 量比 | 当日每分钟量/过去5日每分钟量 | AkShare: `stock_zh_a_spot_em()['量比']` |
| 涨幅 | 当日涨跌幅 | AkShare: `stock_zh_a_spot_em()['涨跌幅']` |
| 振幅 | (最高-最低)/昨日收盘价 | 从`stock_zh_a_spot_em()`计算 |
| 成交额 | 当日成交金额 | AkShare: `stock_zh_a_spot_em()['成交额']` |
| 流通市值 | 流通股本×股价 | AkShare: `stock_zh_a_spot_em()['流通市值']` |
| 总市值 | 总股本×股价 | AkShare: `stock_zh_a_spot_em()['总市值']` |
| 股价 | 当前价格 | AkShare: `stock_zh_a_spot_em()['最新价']` |

### 4. 技术指标

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 均线 | 5/10/20/30/60日均线 | AkShare历史数据计算 |
| MACD | 指数平滑异同移动平均线 | 自计算/TA-Lib/麦蕊智数API |
| KDJ | 随机指标 | 自计算/TA-Lib/麦蕊智数API |
| RSI | 相对强弱指标 | 自计算/TA-Lib/麦蕊智数API |
| BOLL | 布林带 | 自计算/TA-Lib/麦蕊智数API |
| CCI | 商品路径指标 | 自计算/TA-Lib |
| WR | 威廉指标 | 自计算/TA-Lib |

**技术指标计算示例（使用TA-Lib）：**

```python
import akshare as ak
import pandas as pd
import talib

# 获取历史数据
df = ak.stock_zh_a_hist(symbol="000001", adjust="qfq")

# 计算MACD
df['macd'], df['signal'], df['hist'] = talib.MACD(df['close'].values,
    fastperiod=12, slowperiod=26, signalperiod=9)

# 计算KDJ
df['k'], df['d'] = talib.STOCH(df['high'].values, df['low'].values, df['close'].values,
    fastk_period=9, slowk_period=3, slowk_matype=0)
df['j'] = 3 * df['k'] - 2 * df['d']

# 计算RSI
df['rsi'] = talib.RSI(df['close'].values, timeperiod=14)

# 计算BOLL
df['upper'], df['middle'], df['lower'] = talib.BBANDS(df['close'].values,
    timeperiod=20, nbdevup=2, nbdevdn=2, matype=0)
```

### 5. 分时与盘口数据

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 分时线 | 盘中每分钟价格 | AkShare: `stock_zh_a_minute()` |
| 1分钟K线 | 1分钟频率K线 | AkShare: `stock_zh_a_minute()` period='1' |
| 5分钟K线 | 5分钟频率K线 | AkShare: `stock_zh_a_minute()` period='5' |
| 15分钟K线 | 15分钟频率K线 | AkShare: `stock_zh_a_minute()` period='15' |
| 30分钟K线 | 30分钟频率K线 | AkShare: `stock_zh_a_minute()` period='30' |
| 60分钟K线 | 60分钟频率K线 | AkShare: `stock_zh_a_minute()` period='60' |
| 竞价数据 | 集合竞价量价 | 需Level 2数据或东方财富爬虫 |
| 盘口数据 | 买卖5档 | 需Level 2数据 |
| 逐笔成交 | 每笔成交明细 | 需Level 2数据 |

**分时数据获取：**

```python
import akshare as ak

# 获取1分钟分时数据
df_min1 = ak.stock_zh_a_minute(symbol="sh000001", period="1")

# 获取5分钟分时数据
df_min5 = ak.stock_zh_a_minute(symbol="sh000001", period="5")

# 获取历史分钟K线（需要指定日期范围）
# 注意：此接口只能获取近期的分钟数据
```

### 6. 资金流向数据

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 主力净流入 | 超大单+大单净流入 | AkShare: `stock_individual_fund_flow()` |
| 超大单净流入 | 超大单(>100万股)净流入 | AkShare: `stock_individual_fund_flow()` |
| 大单净流入 | 大单(10-100万股)净流入 | AkShare: `stock_individual_fund_flow()` |
| 中单净流入 | 中单(1-10万股)净流入 | AkShare: `stock_individual_fund_flow()` |
| 小单净流入 | 小单(<1万股)净流入 | AkShare: `stock_individual_fund_flow()` |
| 主力净占比 | 主力净流入/成交额 | 计算 |
| 5日资金流向 | 近5日累计资金流向 | AkShare: `stock_individual_fund_flow()` 获取多日 |
| 10日资金流向 | 近10日累计资金流向 | AkShare: `stock_individual_fund_flow()` 获取多日 |

### 7. 龙虎榜与游资席位数据

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 龙虎榜详情 | 当日龙虎榜数据 | AkShare: `stock_lhb_detail_em()` |
| 营业部排行-上榜次数 | 历史累计上榜次数 | AkShare: `stock_lh_yyb_most()` |
| 营业部排行-资金实力 | 历史累计买入金额 | AkShare: `stock_lh_yyb_capital()` |
| 每日活跃营业部 | 当日活跃营业部 | AkShare: `stock_lhb_hyyyb_em()` |
| 机构席位追踪 | 机构席位买卖统计 | AkShare: `stock_sina_lhb_jgzz()` |
| 游资席位历史 | 特定营业部历史操作 | 东方财富爬虫/手动 |
| 席位持仓成本 | 营业部持仓成本估算 | 从龙虎榜数据计算 |

### 8. 涨停板专用数据

| 指标名称 | 说明 | 数据获取方式 |
|---------|------|-------------|
| 涨停股代码名称 | 当日涨停股票列表 | AkShare: `stock_zh_a_limit_up_em()` |
| 涨停时间 | 首次涨停时间 | AkShare: `stock_zh_a_limit_up_em()` |
| 封板金额 | 封涨停板金额 | 从`stock_zh_a_limit_up_em()`获取 |
| 封板速度 | 从开盘到涨停时间 | 计算 |
| 封单量 | 涨停板封单数量 | 需Level 2数据 |
| 封单变化 | 封单增减变化 | 需Level 2数据 |
| 涨停原因 | 涨停原因说明 | 需从公告/研报获取 |
| 连续涨停 | 连续涨停天数 | 从历史涨停数据计算 |

---

## 四、免费Python库

### 1. AkShare

**官网：** https://akshare.akfamily.xyz/

**特点：**

- 完全开源且免费的金融数据接口库
- 数据源涵盖东方财富、新浪财经等
- 支持股票、期货、期权、宏观经济等
- 社区活跃，持续更新
- 无需注册，完全免费

**常用接口：**

```python
import akshare as ak

# 实时行情
df = ak.stock_zh_a_spot_em()

# 历史K线
df = ak.stock_zh_a_hist(symbol="000001", period="daily", start_date="20240101", end_date="20241231")

# 涨停板数据
df = ak.stock_zh_a_limit_up_em()

# 跌停板数据
df = ak.stock_zh_a_limit_down_em()

# 资金流向
df = ak.stock_individual_fund_flow(stock="000001")

# 龙虎榜数据
df = ak.stock_lhb_detail_em(start_date="20240101")

# 龙虎榜营业部排行-上榜次数最多
df = ak.stock_lh_yyb_most()

# 龙虎榜营业部排行-资金实力最强
df = ak.stock_lh_yyb_capital()

# 每日活跃营业部
df = ak.stock_lhb_hyyyb_em(start_date="20240101", end_date="20240101")

# 机构席位追踪
df = ak.stock_sina_lhb_jgzz(recent_day="5")

# 行业板块行情
df = ak.stock_board_industry_name_em()

# 概念板块行情
df = ak.stock_board_concept_name_em()

# 板块资金流向排名
df = ak.stock_sector_fund_flow_rank(indicator="今日", sector_type="行业资金流")

# 分时数据
df = ak.stock_zh_a_minute(symbol="sh000001", period="5")
```

---

### 2. Tushare

**官网：** https://tushare.pro/

**特点：**

- 国内最知名的开源金融数据接口
- 提供股票、期货、基金、外汇、数字货币等数据
- 高频数据：Level 2行情、资金流向
- 返回数据格式为Pandas DataFrame
- 基础数据免费，高级数据需积分

**积分机制：**

- 新用户注册送120积分
- 完善个人信息、邀请用户、提交文章可获积分
- 付费可购买积分（50元=500积分）
- 积分有效期1年

**常用接口：**

```python
import tushare as ts

# 设置token（需要注册获取）
ts.set_token('your_token')
pro = ts.pro_api()

# 获取历史行情
df = pro.daily(ts_code='600519.SH', start_date='20240101', end_date='20241231')

# 获取实时行情
df = ts.get_realtime_quotes(['600519'])

# 获取资金流向
df = pro.moneyflow_hsgt(ts_code='600519.SH')

# 获取龙虎榜明细
df = pro.lhb_detail(start_date='20240101')

# 获取涨停板数据
df = pro.daily_basic(ts_code='', trade_date='20240101', fields='ts_code,trade_date,limit_up')
```

---

### 3. Baostock

**官网：** http://baostock.com/

**特点：**

- 免费开源的证券数据接口
- 主要提供A股历史数据
- 数据质量较高
- 无需注册

**常用接口：**

```python
import baostock as bs
import pandas as pd

# 登录
lg = bs.login()

# 获取历史K线
rs = bs.query_history_k_data_plus("sh.600519",
    "date,code,open,high,low,close,volume,amount",
    start_date='2024-01-01', end_date='2024-12-31')

# 登出
bs.logout()
```

---

### 4. Ashare

**GitHub：** https://github.com/mpquant/Ashare

**特点：**

- 完全免费的A股实时行情数据接口
- 核心库轻量化，只有一个文件
- 新浪财经+腾讯股票双内核，自动故障切换
- 支持日线、周线、月线、分钟线
- 无需注册，完全免费

**常用接口：**

```python
from Ashare import *

# 证券代码格式：sh000001, sz399006, sh600519
# 获取日线历史数据
df = get_price('000001.XSHG', frequency='1d', count=120)

# 获取分钟线数据
df = get_price('000001.XSHG', frequency='5m', count=100)

# 获取实时行情
df = get_realtime_quotes(['000001.XSHG', '600519.XSHG'])
```

---

## 五、商业API服务

### 1. 咕咕数据 (GuguData)

**官网：** https://www.gugudata.com/

**特点：**

- 提供实时涨停板数据
- 毫秒级查询性能
- 支持HTTPS
- 付费服务

**价格参考：**

- 涨停板数据：999元/年 或 249元/月

**接口示例：**

```
API地址: https://api.gugudata.com/stock/cn/stock-limit-up
参数: appkey (付费获取)
返回: 涨停板实时数据
```

---

### 2. 麦蕊智数

**官网：** https://www.mairui.club/

**特点：**

- 专业股票数据API服务商
- 数据接口全面：股票列表、基本面、实时交易、历史交易、资金流、KDJ、MACD、MA、BOLL等
- 服务稳定
- 免费额度：每天500次
- 收费价格实惠

**常用接口：**

```python
import requests

# 实时行情
url = "http://api.mairui.club/hsrl/sp realtime_quotes/000001/您的apikey"
response = requests.get(url)
data = response.json()

# 历史K线
url = "http://api.mairui.club/hsrl/kline/000001/d/20240101/20241231/您的apikey"
```

---

### 3. 聚合数据

**官网：** https://www.juhe.cn/

**特点：**

- 专业数据服务平台
- 提供股票实时行情接口
- 免费额度：每天50次
- 服务稳定

---

### 4. 沧海数据

**官网：** https://www.tsanghi.com/

**特点：**

- 全球金融数据API
- 覆盖30+国家、40+交易所
- 股票、指数、ETF、外汇、加密货币等
- 历史数据30年+

---

### 5. 东方财富API

**官网：** https://data.eastmoney.com/

**特点：**

- 数据最全面
- 实时性强
- 免费使用

**数据分类：**

- 实时行情：涨跌幅、成交额、换手率
- 资金流向：主力资金、超大单、大单
- 龙虎榜：营业部数据、游资席位
- 板块数据：行业板块、概念板块

---

### 6. 新浪/腾讯财经API

**特点：**

- 免费实时数据
- 接口稳定
- 延迟较低

**接口地址：**

```
新浪: https://hq.sinajs.cn/list=sh600519
腾讯: https://qt.gtimg.cn/q=sh600519
```

---

### 7. 新浪财经Level 2

**官网：** https://finance.sina.com.cn/focus/jiaoyi/lv2-intro-hk.shtml

**特点：**

- 十档盘口，毫秒延迟
- 逐笔明细，掌握交易详情
- 分时分析，洞察行情走向

**价格：**

- A股Level 2标准版：168元/月，998元/年

---

## 六、数据类型对应API

### 1. 情绪周期数据

| 数据项 | 数据来源 | 获取方式 |
|-------|---------|---------|
| 涨停数量 | AkShare | `stock_zh_a_limit_up_em()` |
| 跌停数量 | AkShare | `stock_zh_a_limit_down_em()` |
| 炸板率 | 东方财富 | 计算公式：(涨停被砸数/涨停总数)×100% |
| 连板高度 | 东方财富/AkShare | 实时行情+连板统计 |
| 赚钱/亏钱效应 | 东方财富 | 资金流向统计 |
| 昨日涨停今日表现 | AkShare | `stock_zh_a_limit_up_em()`对比历史 |

### 2. 板块效应数据

| 数据项 | 数据来源 | 获取方式 |
|-------|---------|---------|
| 板块涨跌停 | AkShare | `stock_board_industry_name_em()` |
| 板块资金流向 | AkShare | `stock_sector_fund_flow_rank()` |
| 板块轮动 | AkShare | `stock_board_industry_name_em()`对比 |
| 概念板块 | AkShare | `stock_board_concept_name_em()` |

### 3. 游资席位数据

| 数据项 | 数据来源 | 获取方式 |
|-------|---------|---------|
| 龙虎榜详情 | AkShare | `stock_lhb_detail_em()` |
| 营业部排行-上榜次数 | AkShare | `stock_lh_yyb_most()` |
| 营业部排行-资金实力 | AkShare | `stock_lh_yyb_capital()` |
| 每日活跃营业部 | AkShare | `stock_lhb_hyyyb_em()` |
| 机构席位追踪 | AkShare | `stock_sina_lhb_jgzz()` |
| 游资席位历史操作 | 东方财富 | 手动/爬虫获取 |

### 4. 选股量化数据

| 数据项 | 数据来源 | 获取方式 |
|-------|---------|---------|
| 换手率 | AkShare/Tushare | `stock_zh_a_spot_em()` |
| 量比 | AkShare/Tushare | 实时行情 |
| 股价 | AkShare/Tushare | 实时行情 |
| 振幅 | AkShare/Tushare | 实时行情 |
| 均线 | Baostock/AkShare | 历史数据计算 |

### 5. 技术指标数据

| 数据项 | 数据来源 | 获取方式 |
|-------|---------|---------|
| MACD | 自计算/Pandas TA-Lib | 基于K线数据 |
| KDJ | 自计算/Pandas TA-Lib | 基于K线数据 |
| RSI | 自计算/Pandas TA-Lib | 基于K线数据 |
| 布林带 | 自计算/Pandas TA-Lib | 基于K线数据 |

---

## 七、推荐数据获取方案

### 方案一：完全免费（推荐）

```python
import akshare as ak
import baostock as bs
import pandas as pd

# 1. 实时行情
stock_spot = ak.stock_zh_a_spot_em()

# 2. 涨停板
limit_up = ak.stock_zh_a_limit_up_em()

# 3. 跌停板
limit_down = ak.stock_zh_a_limit_down_em()

# 4. 资金流向
fund_flow = ak.stock_individual_fund_flow(stock="000001")

# 5. 龙虎榜
lhb = ak.stock_lhb_detail_em(start_date="20240101")

# 6. 历史K线
hist = ak.stock_zh_a_hist(symbol="000001", period="daily")

# 7. 板块数据
sector = ak.stock_board_industry_name_em()

# 8. 营业部排行
yyb_most = ak.stock_lh_yyb_most()
yyb_capital = ak.stock_lh_yyb_capital()

# 9. 每日活跃营业部
hyyyb = ak.stock_lhb_hyyyb_em(start_date="20240101", end_date="20240101")
```

### 方案二：AkShare + Tushare增强

```python
import akshare as ak
import tushare as ts

# 需要注册获取token
ts.set_token('your_token')
pro = ts.pro_api()

# AkShare用于免费数据
spot = ak.stock_zh_a_spot_em()
limit_up = ak.stock_zh_a_limit_up_em()

# Tushare用于需要积分的数据
df = pro.daily(ts_code='000001.SZ', start_date='20240101')
df = pro.moneyflow_hsgt(ts_code='000001.SZ')
df = pro.lhb_detail(start_date='20240101')
```

### 方案三：综合方案

```python
import akshare as ak
import baostock as bs
import pandas as pd
from Ashare import *

# 基础数据用AkShare（免费全功能）
# 历史数据用Baostock（高质量历史数据）
# 实时数据用Ashare（轻量快速）
# 游资席位用AkShare龙虎榜接口
```

---

## 八、数据更新频率

| 数据类型 | 更新频率 | 建议获取时间 |
|---------|---------|-------------|
| 实时行情 | 实时 | 交易时间段 |
| 涨停板 | 实时 | 交易时间段 |
| 资金流向 | 盘中实时 | 交易时间段 |
| 龙虎榜 | 收盘后 | 16:00后 |
| 历史K线 | 日终更新 | 收盘后 |
| 技术指标 | 日终更新 | 收盘后 |
| 营业部排行 | 日终更新 | 收盘后 |

---

## 九、实战数据获取示例

```python
import akshare as ak
import pandas as pd

def get_market_sentiment():
    """获取市场情绪数据"""
    # 涨停数量
    limit_up = ak.stock_zh_a_limit_up_em()
    limit_down = ak.stock_zh_a_limit_down_em()

    # 计算炸板率（简化）
    # 实际需要获取当日曾涨停但未封住的股票

    return {
        '涨停数': len(limit_up),
        '跌停数': len(limit_down),
        '涨停比例': len(limit_up) / (len(limit_up) + len(limit_down)) if len(limit_up) + len(limit_down) > 0 else 0
    }

def get_sector_data():
    """获取板块数据"""
    # 行业板块涨跌
    sector = ak.stock_board_industry_name_em()
    return sector.sort_values('涨跌幅', ascending=False)

def get_stock_quant():
    """获取股票量化指标"""
    # 实时行情
    spot = ak.stock_zh_a_spot_em()

    # 筛选条件
    selected = spot[
        (spot['换手率'] > 3) &
        (spot['量比'] > 1.5) &
        (spot['涨跌幅'] > 3) &
        (spot['涨跌幅'] < 10)
    ]

    return selected

def get_lhb_data(date):
    """获取龙虎榜数据"""
    lhb = ak.stock_lhb_detail_em(start_date=date)
    return lhb

def get_yyb_rank():
    """获取游资营业部排行"""
    # 上榜次数最多
    yyb_most = ak.stock_lh_yyb_most()

    # 资金实力最强
    yyb_capital = ak.stock_lh_yyb_capital()

    return {
        '上榜次数': yyb_most,
        '资金实力': yyb_capital
    }

def get_institutional_tracking(days=5):
    """获取机构席位追踪"""
    df = ak.stock_sina_lhb_jgzz(recent_day=str(days))
    return df
```

---

## 十、注意事项

1. **数据延迟**：免费API可能存在几秒到几分钟的延迟
2. **接口稳定性**：免费接口可能不稳定，建议增加重试机制
3. **数据清洗**：获取后需进行数据清洗和验证
4. **合规性**：遵守数据提供方的使用条款
5. **频率限制**：注意API调用频率限制
6. **积分权限**：Tushare高级数据需要积分，根据需求选择
7. **数据备份**：重要数据建议本地备份

---

## 十二、游资策略实战数据获取示例

### 1. 首板选股数据获取

```python
import akshare as ak
import pandas as pd

def get_first_board_stocks():
    """获取首板候选股票"""
    # 获取实时行情
    spot = ak.stock_zh_a_spot_em()

    # 获取涨停板数据
    limit_up = ak.stock_zh_a_limit_up_em()

    # 筛选条件
    # 换手率 > 3%
    # 量比 > 1.3
    # 涨幅 3-7%（刚涨停或接近涨停）
    # 股价 < 100元
    # 流通市值 50-300亿

    # 获取板块涨停数
    sector_count = limit_up.groupby('所属行业').size().sort_values(ascending=False)

    # 筛选首板候选（需要结合历史数据判断是否是首板）
    candidates = spot[
        (spot['换手率'] > 3) &
        (spot['量比'] > 1.3) &
        (spot['涨跌幅'] > 3) &
        (spot['涨跌幅'] < 10) &
        (spot['最新价'] < 100) &
        (spot['流通市值']/1e8 > 50) &
        (spot['流通市值']/1e8 < 300)
    ]

    return {
        'candidates': candidates,
        'sector_count': sector_count
    }
```

### 2. 接力选股数据获取

```python
def get_continue_board_stocks():
    """获取连板候选股票"""
    # 获取涨停板数据
    limit_up = ak.stock_zh_a_limit_up_em()

    # 获取实时行情
    spot = ak.stock_zh_a_spot_em()

    # 筛选二板及以上候选
    # 需要结合历史数据判断连板数
    # 换手率 > 5%
    # 量比 > 2
    # 板块效应明显
    # 市场最高板

    # 获取板块资金流向
    sector_fund = ak.stock_sector_fund_flow_rank(
        indicator="今日",
        sector_type="行业资金流"
    )

    return {
        'limit_up': limit_up,
        'sector_fund': sector_fund
    }
```

### 3. 低吸选股数据获取

def get_low_suction_stocks():
    """获取低吸候选股票"""
    # 获取历史数据计算均线
    # 获取回调到10日线附近的股票
    # 缩量企稳（量比 < 1）

    # 获取个股资金流向
    fund_flow = ak.stock_individual_fund_flow(stock="000001")

    return fund_flow

### 4. 情绪周期判断数据获取

```python
def get_sentiment_cycle():
    """判断市场情绪周期"""
    # 涨停数量
    limit_up = ak.stock_zh_a_limit_up_em()

    # 跌停数量
    limit_down = ak.stock_zh_a_limit_down_em()

    # 实时行情统计
    spot = ak.stock_zh_a_spot_em()
    up_count = len(spot[spot['涨跌幅'] > 0])
    down_count = len(spot[spot['涨跌幅'] < 0])

    # 空间板（最高连板）
    max_board = limit_up['连续涨停'].max() if '连续涨停' in limit_up.columns else 0

    # 判断所处阶段
    if len(limit_up) < 10:
        return '冰点期'
    elif len(limit_up) < 30:
        return '启动期'
    elif len(limit_up) < 60:
        return '发酵期'
    elif len(limit_up) >= 60:
        return '高潮期'
    else:
        return '混沌期'
```

### 5. 游资席位追踪数据获取

```python
def get_hot_money_tracking():
    """追踪游资席位操作"""
    # 获取当日龙虎榜
    lhb = ak.stock_lhb_detail_em(start_date="20240101")

    # 获取营业部排行
    yyb_most = ak.stock_lh_yyb_most()
    yyb_capital = ak.stock_lh_yyb_capital()

    # 获取每日活跃营业部
    hyyyb = ak.stock_lhb_hyyyb_em(
        start_date="20240101",
        end_date="20240101"
    )

    # 获取机构席位追踪
    jgzz = ak.stock_sina_lhb_jgzz(recent_day="5")

    return {
        'lhb': lhb,
        'yyb_most': yyb_most,
        'yyb_capital': yyb_capital,
        'hyyyb': hyyyb,
        'jgzz': jgzz
    }
```

### 6. 板块效应分析数据获取

```python
def get_sector_effect():
    """分析板块效应"""
    # 获取涨停板数据
    limit_up = ak.stock_zh_a_limit_up_em()

    # 板块涨停统计
    sector_count = limit_up.groupby('所属行业').agg({
        '代码': 'count',
        '最新价': 'mean'
    }).rename(columns={'代码': '涨停数'})

    # 获取板块涨幅
    sector = ak.stock_board_industry_name_em()

    # 获取板块资金流向
    sector_fund = ak.stock_sector_fund_flow_rank(
        indicator="今日",
        sector_type="行业资金流"
    )

    # 合并数据
    sector_analysis = sector.merge(
        sector_count,
        left_on='名称',
        right_index=True,
        how='left'
    )

    return {
        'sector_count': sector_count.sort_values('涨停数', ascending=False),
        'sector': sector.sort_values('涨跌幅', ascending=False),
        'sector_fund': sector_fund
    }
```

---

## 十三、需要付费的高级数据

### Level 2行情数据

部分数据需要Level 2权限或付费获取：

| 数据项 | 说明 | 获取方式 |
|-------|------|---------|
| 十档盘口 | 买卖10档挂单 | 券商Level 2/付费API |
| 逐笔成交 | 每笔成交明细 | 券商Level 2/付费API |
| 逐笔委托 | 每笔委托明细 | 券商Level 2/付费API |
| 竞价数据 | 集合竞价详情 | 券商Level 2/付费API |
| 封单变化 | 涨停板封单实时变化 | 付费API |

### 付费数据源推荐

1. **券商Level 2**：大多数券商提供，免费或低价
2. **新浪财经Level 2**：168元/月
3. **咕咕数据**：999元/年
4. **麦蕊智数**：免费500次/天，付费价格实惠

---

## 十四、成熟APP推荐

### 1. 开盘啦

**官网：** https://www.kaipanla.com/

**特点：** 专为短线交易设计的数据化平台

**核心功能：**

| 功能 | 说明 |
|-----|------|
| 集合竞价异动 | 实时分析集合竞价买卖挂单数据，提前披露主力异动 |
| 实时龙虎榜 | 首创实时监控主力资金动向，自由拖动时间轴查看 |
| 深度龙虎榜 | 游资解密，挖掘市场资金合力，关联营业部追踪 |
| 市场情绪 | 实时跟踪预测沪深两市量能，把握市场变盘节点 |
| 板块强度 | 研究员精选概念组合，结合涨停数量直观展示 |
| 复盘啦 | 当日盘面亮点、亏钱效应提示、各板块核心个股整合 |
| 区间统计 | 特色时间轴，行情区间统计随意拉动 |
| 竞价系统 | 打板利器，早盘竞价、板块竞价多维分析 |

**游资追踪：** 内置50+游资组合（六一中路、方新侠、赵老哥、上海超短、炒股养家、作手新一、小鳄鱼等）

**收费：** 免费版功能丰富，会员版提供更多高级功能

---

### 2. 短线王

**官网：** http://www.duanxianwang.cn/

**特点：** AI+大数据技术，专注短线交易

**核心功能：**

| 功能 | 说明 |
|-----|------|
| AI擒龙 | AI选股，根据K线形态、资金、事件捕捉次日潜力龙头 |
| 竞价龙头 | 根据集合竞价挂单差、涨跌幅、量比捕捉当日潜力妖股 |
| 尾盘擒龙 | 14:00根据K线形态、资金、事件捕捉次日潜力股 |
| 复盘宝 | 按题材、涨停板数快速梳理盘面，锁定热门题材 |
| 板块风云榜 | 细分板块+AI诊断，快速定位市场热点 |
| 游资分析 | 知名游资手法分析，包括营业部、常用手法、喜好板块 |

**收费：** 免费版可用，会员版提供更多AI选股功能

---

### 3. 同花顺

**官网：** https://www.10jqka.com.cn/

**特点：** 综合型股票软件，功能全面

**核心功能：**

| 功能 | 说明 |
|-----|------|
| 涨跌停分析 | 实时涨跌停数量统计 |
| 炸板率 | 个股炸板率查看（需自定义公式） |
| 龙虎榜 | 营业部数据、游资追踪 |
| 问财 | 输入自然语言查询数据 |
| Level 2 | 十档盘口、逐笔明细（付费） |

**收费：** 免费版基础功能，会员版（Level 2等）需付费

---

### 4. 东方财富

**官网：** https://www.eastmoney.com/

**特点：** 数据全面，龙虎榜功能强大

**核心功能：**

| 功能 | 说明 |
|-----|------|
| 龙虎榜 | 详细营业部数据、历史回顾 |
| 资金流向 | 主力资金、超大单、大单净流入 |
| 涨停分析 | 每日涨停股详细分析 |
| 板块资金流 | 行业/概念板块资金流向 |
| 机构追踪 | 机构席位买卖统计 |
| Level 2 | 十档行情、超级盘口（付费） |

**收费：** 免费版基础功能，会员版需付费

---

### 5. 通达信

**特点：** 老牌股票软件，公式编写灵活

**核心功能：**

| 功能 | 说明 |
|-----|------|
| 公式系统 | 可自定义编写炸板率等指标 |
| 条件选股 | 灵活的条件筛选 |
| 预警系统 | 实时条件预警 |
| 龙虎榜 | 营业部数据 |

**收费：** 各大券商提供，部分版本付费

---

### 6. 雪球

**官网：** https://xueqiu.com/

**特点：** 投资者社区，数据丰富

**核心功能：**

| 功能 | 说明 |
|-----|------|
| 组合跟投 | 跟随高手操作 |
| 数据 | 财务数据、公告信息 |
| 社区 | 投资者讨论 |

**收费：** 免费

---

### 7. 复盘姬（同花顺旗下）

**特点：** 专注复盘数据

**核心功能：**

| 功能 | 说明 |
|-----|------|
| 点金龙虎榜 | 每日龙虎榜解读 |
| 机构日报评级 | 机构席位分析 |
| 热点追踪 | 市场热点分析 |

**收费：** 部分功能付费

---

## 十五、商业数据平台推荐

### 1. 选股宝

**特点：** 付费投研数据平台

**核心功能：**

- 题材库：题材炒作产业链梳理
- 脱水研报：机构精选研报
- 实时提醒：涨停、异动监控

### 2. 财联社

**特点：** 付费资讯服务

**核心功能：**

- 电报：实时快讯
- 风口：题材热点追踪
- 研报：机构研报

### 3. 芽股

**特点：** 付费数据服务

**核心功能：**

- 资金流向
- 热点追踪
- 龙虎榜数据

---

## 十六、数据获取方案推荐

### 方案一：完全免费（个人投资者）

```
主要工具：AkShare + 开盘啦（免费版）+ 同花顺（免费版）

数据覆盖：
- AkShare：实时行情、历史K线、龙虎榜、资金流向、板块数据
- 开盘啦免费版：集合竞价异动、实时龙虎榜、市场情绪、复盘
- 同花顺免费版：基础行情、问财查询
```

### 方案二：轻量付费（进阶投资者）

```
主要工具：AkShare + 开盘啦会员/短线王会员 + 同花顺Level 2

数据覆盖：
- 免费API：全部基础数据
- 开盘啦会员：深度龙虎榜、游资组合实时追踪、竞价数据
- 同花顺Level 2：十档盘口、逐笔明细、超级盘口
```

### 方案三：专业级（全职交易者）

```
主要工具：开盘啦会员 + 短线王会员 + 券商Level 2 + Tushare Pro

数据覆盖：
- 全部实时数据
- 游资席位追踪
- Level 2盘口数据
- 历史数据深度分析
```

---

## 十七、总结

| 需求场景 | 推荐方案 | 成本 |
|---------|---------|------|
| 学习研究 | AkShare + 免费APP | 0元 |
| 日常交易 | AkShare + 开盘啦免费版 | 0元 |
| 短线进阶 | 开盘啦/短线王会员 + 同花顺Level 2 | 约300-1000元/年 |
| 专业交易 | 全套付费方案 | 2000元+/年 |

---

## 十八、本系统数据同步实现

### 1. 系统架构

本系统后端基于 FastAPI + SQLModel + SQLite，前端使用 React + TypeScript。

**数据库模型（Stock）：**
```python
class Stock(SQLModel, table=True):
    __tablename__ = "stocks"

    id: Optional[int] = Field(default=None, primary_key=True)
    code: str = Field(index=True, description="股票代码")
    name: str = Field(description="股票名称")
    sector: Optional[str] = Field(default=None, description="所属行业")
    price: Optional[float] = Field(default=None, description="当前价格")
    change: Optional[float] = Field(default=None, description="涨跌幅")
    turnover_rate: Optional[float] = Field(default=None, description="换手率")
    volume_ratio: Optional[float] = Field(default=None, description="量比")
    market_cap: Optional[float] = Field(default=None, description="总市值")
    amplitude: Optional[float] = Field(default=None, description="振幅")
    limit_consecutive: Optional[int] = Field(default=None, description="连板天数")
    is_limit_up: bool = Field(default=False, description="是否涨停")
    is_limit_down: bool = Field(default=False, description="是否跌停")
    trade_date: Optional[str] = Field(default=None, description="交易日期")
```

### 2. 数据同步API

系统提供以下数据同步接口：

#### 2.1 同步全部股票列表
```
POST /api/sync/stocks/all
```
从 baostock 获取全部A股股票列表（~5000只）。

#### 2.2 同步热门股票行情
```
POST /api/sync/quotes/baostock-popular
```
同步24只热门股票（蓝筹股、白马股）的实时行情数据。

**热门股票列表：**
| 代码 | 名称 |
|-----|------|
| 600519 | 贵州茅台 |
| 600036 | 招商银行 |
| 000001 | 平安银行 |
| 600000 | 浦发银行 |
| 000858 | 五粮液 |
| 600030 | 中信证券 |
| 300750 | 宁德时代 |
| 002594 | 比亚迪 |
| 601318 | 中国平安 |
| 601166 | 兴业银行 |
| 601398 | 工商银行 |
| 601288 | 农业银行 |
| 601988 | 中国银行 |
| 601939 | 建设银行 |
| 600036 | 招商银行 |
| 000002 | 万科A |
| 000333 | 美的集团 |
| 000651 | 格力电器 |
| 002475 | 立讯精密 |
| 300059 | 东方财富 |
| 600900 | 长江电力 |
| 601012 | 隆基绿能 |
| 600276 | 恒瑞医药 |
| 002230 | 科大讯飞 |

### 3. Baostock 股票代码格式

**重要：Baostock 要求特定的股票代码格式：**

| 市场 | 格式 | 示例 |
|-----|------|------|
| 上海主板 | `sh.6xxxxx` | `sh.600519`（贵州茅台） |
| 深圳主板 | `sz.0xxxxx` | `sz.000001`（平安银行） |
| 创业板 | `sz.3xxxxx` | `sz.300750`（宁德时代） |

**代码转换逻辑：**
```python
def convert_code(code: str) -> str:
    """将6位股票代码转换为baostock格式"""
    if code.startswith('6'):
        return f"sh.{code}"
    elif code.startswith(('0', '3')):
        return f"sz.{code}"
    else:
        return f"sh.{code}"  # 默认上海
```

### 4. 同步流程

**步骤1：启动后端服务**
```bash
cd backend
uvicorn app.main:app --reload
```

**步骤2：同步股票列表**
```bash
curl -X POST http://localhost:8000/api/sync/stocks/all
```

**步骤3：同步热门股票行情**
```bash
curl -X POST http://localhost:8000/api/sync/quotes/baostock-popular
```

**验证同步结果：**
```bash
curl http://localhost:8000/api/stocks
```

### 5. API查询示例

#### 5.1 查询全部股票
```bash
curl http://localhost:8000/api/stocks
```

#### 5.2 按代码查询
```bash
curl http://localhost:8000/api/stocks/600519
```

#### 5.3 搜索股票
```bash
curl "http://localhost:8000/api/stocks/search?name=茅台"
```

### 6. 同步状态验证

同步成功后，数据库应包含：
- **股票列表**：5190只股票（包含代码和名称）
- **热门股票行情**：24只股票（含实时价格、涨跌幅、换手率等）

**验证示例：**
```python
# 查询贵州茅台
Stock.filter(Stock.code == "600519").first()
# 结果: {'code': '600519', 'name': '贵州茅台', 'price': 1469.68, 'change': -0.07, ...}

# 查询招商银行
Stock.filter(Stock.code == "600036").first()
# 结果: {'code': '600036', 'name': '招商银行', 'price': 36.72, 'change': -0.81, ...}
```

### 7. 注意事项

1. **股票代码格式**：数据库存储6位代码，同步时需转换为 baostock 格式
2. **交易时间段**：实时行情仅在交易时间可用
3. **数据延迟**：baostock 数据可能有几秒延迟
4. **频率限制**：建议每日同步一次，避免频繁调用

---

## 十九、相关资源

- **Tushare文档：** https://tushare.pro/document/api
- **AkShare文档：** https://akshare.akfamily.xyz/
- **Baostock文档：** http://baostock.com/
- **Ashare GitHub：** https://github.com/mpquant/Ashare
- **东方财富数据：** https://data.eastmoney.com/
- **麦蕊智数：** https://www.mairui.club/
- **咕咕数据：** https://www.gugudata.com/
- **TA-Lib文档：** https://ta-lib.org/
- **开盘啦：** https://www.kaipanla.com/
- **短线王：** http://www.duanxianwang.cn/
